# اطلاعات بازار (عمومی)

<h2 id="orderbook">لیست سفارش‌ها: اردربوک</h2>

```shell
curl 'https://api.nobitex.ir/v2/orderbook/BTCIRT'
```

```plaintext
http GET https://api.nobitex.ir/v2/orderbook/BTCIRT
```

> در صورت فراخوانی درست، پاسخ به این صورت خواهد بود:

```json
{
    "status": "ok",
    "lastUpdate": 1644991756704,
    "bids": [
        ["1476091000", "1.016"],
        ["1479700000", "0.2561"]
    ],
    "asks": [
        ["1470001120", "0.126571"],
        ["1470000000", "0.818994"]
    ]
}
```

برای دریافت لیست سفارش‌ها یا همان اردربوک بازارهای مختلف، از این درخواست استفاده نمایید:

- **درخواست:** `GET /v2/orderbook/SYMBOL`
- **محدودیت فراخوانی:** 60 درخواست در دقیقه
- **نیاز به ارسال توکن:** ندارد

<aside class="warning">
برای دریافت اردربوک حتماً از متد GET و با ارسال نماد در آدرس url استفاده نمایید. روش قدیمی مبتنی بر POST دیگر پشتیبانی نمی‌شود.
</aside>

### پارامترهای ورودی

پارامتر     | نوع    | پیش‌فرض   |  توضیحات   | نمونه
----------- | ----   | ------   | ---------  | -----
SYMBOL | string |   الزامی | نماد بازار | `BTCIRT`

<aside class="notice">
لیست نمادهای معتبر بازارها عبارتند از:<br/> <span class="market-symbols"></span>
</aside>

> نمونه پاسخ درخواست /v2/orderbook/all:

```json
{
  "status": "ok",
  "BTCIRT": {
    "lastUpdate": 1644991756704,
    "bids": [
      ["1476091000", "1.016"],
      ["1479700000", "0.2561"]
    ],
    "asks": [
      ["1470001120", "0.126571"],
      ["1470000000", "0.818994"]
    ]
  },
  "USDTIRT": {
    "lastUpdate": 1644991767392,
    "bids": [
      ["277990", "6688.3"],
      ["278000", "28185.03"]
    ],
    "asks": [
      ["277960", "119.31"],
      ["277960", "1079.75"]
    ]
  }
}
```

<aside class="notice">
در صورت تمایل به دریافت لیست سفارشات همه بازارها به صورت یکجا از مقدار <code>all</code> برای symbol استفاده نمایید.
</aside>

### پارامترهای پاسخ
خروجی شامل دو آرایه asks و bids بوده که در هر یک قیمت و مقدار سفارش‌های بازار وجود دارد. به دلایل تاریخی سفارش‌های فروش در `bids` و سفارش‌های خرید در `asks` بازگردانده می‌شوند. هر یک از این آرایه‌ها شامل دوتایی‌های «قیمت، مقدار» هستند.

همچنین زمان آخرین به‌روزرسانی در اردربوک ذیل پارامتر `lastUpdate` به فرمت یونیکس داده می‌شود.

### روش پیشنهادی نگهداری اردربوک
در صورتی که در کد خود نیاز به نگهداری آخرین وضعیت اردربوک نوبیتکس هستید، در یک حلقه اقدام به دریافت اردربوک نوبیتکس نمایید. حتماً در میان هر دو بار اجرای حلقه حداقل یک تا ده ثانیه صبر نمایید و از فراخوانی پیاپی و بی‌مکث اردربوک خودداری کنید. به دلیل وجود لایه‌های کش، در صورت فراخوانی در بازه‌های زیر یک ثانیه، همان داده فراخوانی قبلی را دریافت خواهید نمود. اگر در اغلب بازارهای نوبیتکس فعال هستید، می‌توانید در هر فراخوانی کل اردربوک را دریافت نمایید تا نیازی به فراخوانی همزمان چند اردربوک نداشته باشید. اگر کد خود را در چند رشته (ترد) یا پردازه یا سرور اجرا می‌کنید، حتماً اردربوک را در یک مرجع واحد دریافت نمایید و آن را در میان نمونه‌های برنامه خود به اشتراک بگذارید.


## لیست معاملات

```shell
curl 'https://api.nobitex.ir/v2/trades/BCHIRT'
```

```plaintext
http GET https://api.nobitex.ir/v2/trades/BCHIRT
```

> در صورت فراخوانی درست، پاسخ به این صورت خواهد بود:

```json
{
    "status": "ok",
    "trades": [
        {
            "time": 1588689375067,
            "price": "1470000110",
            "volume": "0",
            "type": "sell"
        },
        {
            "time": 1588689360464,
            "price": "1470000110",
            "volume": "0.002",
            "type": "buy"
        }
    ]
}
```

برای دریافت لیست معاملات از این نوع درخواست استفاده نمایید:

- آدرس : `GET v2/trades/SYMBOL `

- پارامترها :

پارامتر     | نوع    | پیش‌فرض   |  توضیحات   | نمونه
----------- | ----   | ------   | ---------  | -----
symbol | string |   الزامی | نماد | `BTCIRT`


<aside class="notice">
محدودیت فراخوانی : 15 درخواست در دقیقه
</aside>
<aside class="notice">
در این api نیاز به توکن وجود ندارد.
</aside>
<aside class="notice">
لیست نمادهای بازار ها عبارتند از: <span class="market-symbols"></span>
که می بایست یکی از این نمادها را به صورت پارامتر با نام symbol به آدرس api ارسال و استفاده نمائید
</aside>
<aside class="notice">
پارامتر بازگشتی time زمان دقیق انجام شدن معامله است که با فرمت <a href="https://fa.wikipedia.org/wiki/%D8%B3%D8%A7%D8%B9%D8%AA_%DB%8C%D9%88%D9%86%DB%8C%DA%A9%D8%B3" target="_blank">یونیکس</a> نمایش داده میشود
</aside>

##آمار بازار نوبیتکس

```shell
curl 'https://api.nobitex.ir/market/stats' \
  -X POST \
  -H "content-type: application/json" \
  --data '{"srcCurrency":"btc","dstCurrency":"rls"}'
```

```plaintext
http POST https://api.nobitex.ir/market/stats \
  srcCurrency=btc dstCurrency=rls
```

> در صورت فراخوانی درست، پاسخ به این صورت خواهد بود:

```json
{
    "stats": {
        "btc-rls": {
            "bestSell": "749976360.0000000000",
            "isClosed": false,
            "dayOpen": "686021860.0000000000",
            "dayHigh": "750350000.0000000000",
            "bestBuy": "733059600.0000000000",
            "volumeSrc": "0.2929480000",
            "dayLow": "686021860.0000000000",
            "latest": "750350000.0000000000",
            "volumeDst": "212724856.0678640000",
            "dayChange": "9.38",
            "dayClose": "750350000.0000000000"
        }
    },
    "status": "ok"
}
```

برای دریافت آخرین آمار بازار نوبیتکس از این نوع درخواست استفاده نمایید:

- آدرس : `POST /market/stats`

- پارامترها :

پارامتر     | نوع    | پیش‌فرض   |  توضیحات   | نمونه
----------- | ----   | ------   | ---------  | -----
srcCurrency | string |   الزامی | ارزها مبدا | `btc,usdt`
dstCurrency | string |   الزامی | ارز مقصد   | `rls`

<aside class="notice">
محدودیت فراخوانی : 100 درخواست در 10 دقیقه
</aside>
<aside class="notice">
انواع ارز:
<span class="currency-symbols"></span>
</aside>
<aside class="warning">
در شی پاسخ جهت سازگاری با نسخه‌های پیشین، آمار بازار بایننس نیز برگردانده می‌شود.
دقت کنید این قسمت از اطلاعات (متناظر با کلید global) منسوخ شده و در نسخه‌های آتی به طور کامل حذف خواهد شد.
توصیه می‌شود جهت دریافت آمار بازار بایینس از <a href="#cdf265d0e6">آمار بازار جهانی</a> استفاده نمایید.
</aside>

## آمار OHLC بازار نوبیتکس

```shell
curl 'https://api.nobitex.ir/market/udf/history?symbol=BTCIRT&resolution=D&from=1560120967&to=1562230967'
```

```plaintext
http GET https://api.nobitex.ir/market/udf/history?symbol=BTCIRT&resolution=D&from=1560120967&to=1562230967
```

> در صورت فراخوانی درست، پاسخ به این صورت خواهد بود:

```json
{
  "s": "ok",
  "t": [
    1562182200
  ],
  "c": [
    "157000000.0000000000"
  ],
  "o": [
    "150551000.0000000000"
  ],
  "h": [
    "161869500.0000000000"
  ],
  "l": [
    "150551000.0000000000"
  ],
  "v": [
    "9.8592626506"
  ]
}
```



برای توضیحات بیشتر در مورد  OHLC به [این لینک](https://en.wikipedia.org/wiki/Open-high-low-close_chart) مراجعه کنید.<br><br>
برای دریافت  آمار OHLC نوبیتکس از این نوع درخواست استفاده نمایید:

- آدرس : `GET /market/udf/history`

- پارامترها :

پارامتر     | نوع    | پیش‌فرض   |  توضیحات   | نمونه
----------- | ----   | ------   | ---------  | -----
symbol | string |   الزامی | جفت ارز | `BTCIR`
resolution | string |   الزامی |بازه زمانی هر خروجی| `D`
from | int |   الزامی |زمان ابتدای بازه| `1562120967`
to | int |   الزامی |زمان پایان بازه| `1562230967`

- پارامتر Resolution  بازه زمانی  کندل‌های خروجی می‌باشد و مقدار آن می‌تواند یکی از مقادیر زیر باشد:


پارامتر | توضیح
------ | -------
 یک ساعت|`60`
 یک روز|`D`


<aside class="notice">
مقادیر from و to زمان شروع و پایان جست‌وجو را مشخص میکند. برای مثال اگر شما میخواهید بازه 4 ساعته از تاریخ 2019/2/9 11:39:41 را به خروجی های 1 ساعته دریافت کنید،مقادیر شما باید به این صورت باشد:
from: 1567424381
to: 1567395581
resolution: 60
</aside>

<aside class="notice">
در صورت ورودی اشتباه برای resolution پاسخ به این صورت خواهد بود:
`{
   "s": "error",
   "errmsg": "Invalid resolution!"
 }
 `
</aside>



- پاسخ سرور
در هر بازه زمانی، بسته به resolution انتخابی، تعداد مقادیر برگشتی متفاوت میباشد. برای مثال اگر شما اختلاف بازه زمانی خود را 7 روز و resolution را مقدار D یعنی 1 روز انتخاب کنید، 7 پاسخ به شما برگشت داده می‌شود.
هر کدام از این پاسخ‌ها در واقع یک candle هستند.
هر candle، مقادیر زیر را دارد:

پارامتر|توضیح|نوع|نمونه
-----|-------|------|-----
`s`|وضعیت پاسخ|string|`ok`
`t`|زمان|float|`1562182200`
`c`|مقدار انتهای بازه|string|`157000000.0000000000`
`o`|مقدار ابندای بازه|string|`150551000.0000000000`
`h`|بالاترین مقدار بازه|string|`161869500.0000000000`
`l`|پایین ترین مقدار بازه|string|`150551000.0000000000`
`v`|حجم بازه|array|`["9.8592626506"]`

پارامتر o (open) مقدار شروع بازه (در مثال ما بازه 1 روزه) را نشان می‌دهد. یعنی این بازه با مقدار 150551000.0000000000 شروع شده است.

پارامتر c  (close) مقدار پایان بازه را نشان می‌دهد. یعنی این بازه با مقدار 157000000.0000000000 به پایان رسیده‌است.

پارامتر h(high) است. بالاترین مقدار بازه را نشان می‌دهد. یعنی بالاترین مقدار این بازه  "150551000.0000000000"

پارامتر l  (low) پایین‌ ترین مقدار بازه را نشان می‌دهد. پایین ترین مقدار این بازه 150551000.000000 می‌باشد.

پارامتر v  (volume) حجم بازه بازه را نشان می‌دهد. حجم این بازه 9.8592626506 می‌باشد.

## آمار بازار جهانی

```shell
curl 'https://api.nobitex.ir/market/global-stats' \
  -X POST

```

```plaintext
http POST https://api.nobitex.ir/market/global-stats
```

> در صورت فراخوانی درست، پاسخ به این صورت خواهد بود:

```json
{
    "ltc": {
        "kraken": {
            "price": "41.69"
        }
    },
    "btc": {
        "kraken": {
            "price": "5517.2"
        }
    },
    ...

    "status": "ok"
}
```

برای دریافت آمار بازارهای جهانی از این نوع درخواست استفاده نمایید:

- آدرس : `POST /market/global-stats`

<aside class="notice">
این آمارها مربوط به بازارهای Kraken و Binance می باشد
</aside>
<aside class="notice">
محدودیت فراخوانی : 100 درخواست در 10 دقیقه
</aside>
